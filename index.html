<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุงุฑูุช ุงููุงุจููุฉ - ุงูุทูุจ ุงูุณุฑูุน</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #f0f2f5; }
        .navy-bg { background-color: #1e3a8a; }
        .yellow-btn { background-color: #facc15; color: #1e3a8a; }
        .item-card { border-right: 5px solid #facc15; }
    </style>
</head>
<body class="pb-32">

    <header class="navy-bg text-white p-8 rounded-b-[40px] shadow-2xl text-center mb-8 border-b-4 border-yellow-400">
        <h1 class="text-4xl font-bold tracking-tight">๐ ูุงุฑูุช ุงููุงุจููุฉ</h1>
        <p class="text-yellow-400 mt-2 font-medium">ุชุณูู ุจุฐูุงุก.. ูุตูู ุฃูููุง ููุช</p>
    </header>

    <main class="max-w-md mx-auto px-4">
        <div id="loading-spinner" class="text-center py-10 text-blue-900 font-bold">ุฌุงุฑู ุชุญุฏูุซ ูุงุฆูุฉ ุงูููุชุฌุงุช...</div>
        <div id="products-container" class="space-y-4"></div>
    </main>

    <div id="floating-cart" class="fixed bottom-4 left-1/2 transform -translate-x-1/2 w-[90%] max-w-md bg-blue-900 text-white p-4 rounded-2xl shadow-2xl flex justify-between items-center hidden z-50 border-t-4 border-yellow-400">
        <div class="flex items-center gap-3">
            <div class="bg-yellow-400 text-blue-900 w-10 h-10 rounded-full flex items-center justify-center font-bold">
                <span id="cart-count">0</span>
            </div>
            <div>
                <p class="text-xs text-yellow-300">ุงูุฅุฌูุงูู:</p>
                <p class="font-bold text-lg"><span id="cart-total">0</span> ุฏ.ุน</p>
            </div>
        </div>
        <button onclick="sendOrderViaWhatsApp()" class="bg-yellow-400 hover:bg-yellow-300 text-blue-900 py-2 px-6 rounded-xl font-bold transition-all active:scale-95 shadow-md">
            ุฅุฑุณุงู ุงูุทูุจ ๐ฒ
        </button>
    </div>

    <script>
        // ุงูุฑุงุจุท ุงูุฎุงุต ุจู ุชู ูุถุนู ููุง ุจูุฌุงุญ โ
        const sheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR_Ja8kz5VAApLStZ9Y_erhYNqL3eXMafTSR9T8xkI82UzYQMS_efXuIyASXRKZTwYZGp69ExZB-7r3/pub?output=csv';

        async function loadProducts() {
            try {
                const response = await fetch(sheetURL);
                const csvData = await response.text();
                const rows = csvData.split('\n').slice(1); 
                
                const products = rows.map(row => {
                    const columns = row.split(',');
                    if(columns.length >= 3) {
                        return { 
                            name: columns[0].replace(/"/g, '').trim(), 
                            price: columns[1].replace(/"/g, '').trim(), 
                            image: columns[2].replace(/"/g, '').trim() 
                        };
                    }
                }).filter(p => p && p.name);

                renderProducts(products);
                document.getElementById('loading-spinner').classList.add('hidden');
            } catch (e) {
                document.getElementById('loading-spinner').innerHTML = "โ๏ธ ูุดู ูู ุชุญููู ุงูููุชุฌุงุช. ุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช ุงููุดุฑ ูู Google Sheets.";
                console.error(e);
            }
        }

        function renderProducts(items) {
            const container = document.getElementById('products-container');
            container.innerHTML = items.map(item => `
                <div class="bg-white p-4 rounded-2xl shadow-md flex justify-between items-center item-card transition-all active:scale-95">
                    <div class="flex items-center gap-4 flex-1">
                        <img src="images/${item.image}" class="w-20 h-20 object-cover rounded-xl bg-gray-50 border border-gray-100 shadow-sm" onerror="this.src='https://via.placeholder.com/80?text=๐ฆ'">
                        <div>
                            <h3 class="font-bold text-gray-800 text-lg leading-tight">${item.name}</h3>
                            <p class="text-blue-800 font-bold mt-1">${parseInt(item.price).toLocaleString()} ุฏ.ุน</p>
                        </div>
                    </div>
                    <button onclick="addToCart('${item.name}', ${item.price})" class="yellow-btn w-12 h-12 rounded-2xl font-black text-xl flex items-center justify-center shadow-lg active:scale-90">
                        +
                    </button>
                </div>
            `).join('');
        }

        let cart = [];
        let total = 0;

        function addToCart(name, price) {
            cart.push({name, price});
            total += parseInt(price);
            document.getElementById('cart-count').innerText = cart.length;
            document.getElementById('cart-total').innerText = total.toLocaleString();
            document.getElementById('floating-cart').classList.remove('hidden');
            
            // ุงูุชุฒุงุฒ ุจุณูุท ููุชุฃููุฏ
            const cartDiv = document.getElementById('floating-cart');
            cartDiv.classList.add('animate-bounce');
            setTimeout(() => cartDiv.classList.remove('animate-bounce'), 300);
        }

        function sendOrderViaWhatsApp() {
            if (cart.length === 0) return;
            let msg = "ูุฑุญุจุงู ูุงุฑูุช ุงููุงุจููุฉุ ุฃุฑูุฏ ุทูุจ ุงูููุงุฏ ุงูุชุงููุฉ:%0a%0a";
            cart.forEach((it, i) => msg += `${i+1}- ${it.name} (${parseInt(it.price).toLocaleString()} ุฏ.ุน)%0a`);
            msg += `%0a*ุงูุฅุฌูุงูู: ${total.toLocaleString()} ุฏ.ุน*`;
            msg += "%0a%0aูุฑุฌู ุชุฃููุฏ ุงูุทูุจ.";
            
            const myNumber = "9647700000000"; // ๐ฉ ุงุณุชุจุฏู ูุฐุง ุจุฑููู ุงูุญูููู
            window.open(`https://wa.me/${myNumber}?text=${msg}`);
        }

        loadProducts();
    </script>
</body>
</html>
